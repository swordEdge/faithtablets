"use strict";!function(factory){"object"==typeof module&&module.exports?module.exports=factory:factory(Highcharts)}(function(Highcharts){!function(Highcharts){var some,SeriesBuilder,doc=Highcharts.win.document,each=Highcharts.each,objectEach=Highcharts.objectEach,pick=Highcharts.pick,inArray=Highcharts.inArray,isNumber=Highcharts.isNumber,splat=Highcharts.splat,fireEvent=Highcharts.fireEvent;some=Array.prototype.some?function(arr,fn,ctx){Array.prototype.some.call(arr,fn,ctx)}:function(arr,fn,ctx){for(var i=0,len=arr.length;i<len;i++)if(!0===fn.call(ctx,arr[i],i,arr))return};var Data=function(dataOptions,chartOptions){this.init(dataOptions,chartOptions)};Highcharts.extend(Data.prototype,{init:function(options,chartOptions){this.options=options,this.chartOptions=chartOptions,this.columns=options.columns||this.rowsToColumns(options.rows)||[],this.firstRowAsNames=pick(options.firstRowAsNames,!0),this.decimalRegex=options.decimalPoint&&new RegExp("^(-?[0-9]+)"+options.decimalPoint+"([0-9]+)$"),this.rawColumns=[],this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var i,chartOptions=this.chartOptions,options=this.options,xColumns=[],getValueCount=function(type){return(Highcharts.seriesTypes[type||"line"].prototype.pointArrayMap||[0]).length},getPointArrayMap=function(type){return Highcharts.seriesTypes[type||"line"].prototype.pointArrayMap},globalType=chartOptions&&chartOptions.chart&&chartOptions.chart.type,individualCounts=[],seriesBuilders=[],seriesIndex=0;each(chartOptions&&chartOptions.series||[],function(series){individualCounts.push(getValueCount(series.type||globalType))}),each(options&&options.seriesMapping||[],function(mapping){xColumns.push(mapping.x||0)}),0===xColumns.length&&xColumns.push(0),each(options&&options.seriesMapping||[],function(mapping){var builder=new SeriesBuilder,numberOfValueColumnsNeeded=individualCounts[seriesIndex]||getValueCount(globalType),series=(chartOptions&&chartOptions.series||[])[seriesIndex]||{},pointArrayMap=getPointArrayMap(series.type||globalType)||["y"];for(builder.addColumnReader(mapping.x,"x"),objectEach(mapping,function(val,name){"x"!==name&&builder.addColumnReader(val,name)}),i=0;i<numberOfValueColumnsNeeded;i++)builder.hasReader(pointArrayMap[i])||builder.addColumnReader(undefined,pointArrayMap[i]);seriesBuilders.push(builder),seriesIndex++});var globalPointArrayMap=getPointArrayMap(globalType);globalPointArrayMap===undefined&&(globalPointArrayMap=["y"]),this.valueCount={global:getValueCount(globalType),xColumns:xColumns,individual:individualCounts,seriesBuilders:seriesBuilders,globalPointArrayMap:globalPointArrayMap}},dataFound:function(){this.options.switchRowsAndColumns&&(this.columns=this.rowsToColumns(this.columns)),this.getColumnDistribution(),this.parseTypes(),!1!==this.parsed()&&this.complete()},parseCSV:function(inOptions){function parseRow(columnStr,rowNumber,noAdd,callbacks){function read(j){c=columnStr[j],cl=columnStr[j-1],cn=columnStr[j+1]}function pushType(type){dataTypes.length<column+1&&dataTypes.push([type]),dataTypes[column][dataTypes[column].length-1]!==type&&dataTypes[column].push(type)}function push(){if(actualColumn<startColumn||endColumn<actualColumn)return++actualColumn,void(token="");!isNaN(parseFloat(token))&&isFinite(token)?(token=parseFloat(token),pushType("number")):isNaN(Date.parse(token))?pushType("string"):(token=token.replace(/\//g,"-"),pushType("date")),columns.length<column+1&&columns.push([]),noAdd||(columns[column][rowNumber]=token),token="",++column,++actualColumn}var i=0,c="",cl="",cn="",token="",actualColumn=0,column=0;if(columnStr.trim().length&&"#"!==columnStr.trim()[0]){for(;i<columnStr.length;i++){if(read(i),"#"===c)return void push();if('"'===c)for(read(++i);i<columnStr.length&&('"'!==c||'"'===cl||'"'===cn);)('"'!==c||'"'===c&&'"'!==cl)&&(token+=c),read(++i);else callbacks&&callbacks[c]?callbacks[c](c,token)&&push():c===itemDelimiter?push():token+=c}push()}}function guessDelimiter(lines){var points=0,commas=0,guessed=!1;return some(lines,function(columnStr,i){var c,cn,cl,inStr=!1,token="";if(13<i)return!0;for(var j=0;j<columnStr.length;j++){if(c=columnStr[j],cn=columnStr[j+1],cl=columnStr[j-1],"#"===c)return;if('"'===c)if(inStr){if('"'!==cl&&'"'!==cn){for(;" "===cn&&j<columnStr.length;)cn=columnStr[++j];"undefined"!=typeof potDelimiters[cn]&&potDelimiters[cn]++,inStr=!1}}else inStr=!0;else"undefined"!=typeof potDelimiters[c]?(token=token.trim(),isNaN(Date.parse(token))&&!isNaN(token)&&isFinite(token)||potDelimiters[c]++,token=""):token+=c;","===c&&commas++,"."===c&&points++}}),guessed=potDelimiters[";"]>potDelimiters[","]?";":(potDelimiters[","],potDelimiters[";"],","),options.decimalPoint||(options.decimalPoint=commas<points?".":",",self.decimalRegex=new RegExp("^(-?[0-9]+)"+options.decimalPoint+"([0-9]+)$")),guessed}function deduceDateFormat(data,limit){var thing,guessedFormat,calculatedFormat,j,format="YYYY/mm/dd",i=0,madeDeduction=!1,stable=[],max=[];for((!limit||limit>data.length)&&(limit=data.length);i<limit;i++)if("undefined"!=typeof data[i]&&data[i]&&data[i].length)for(thing=data[i].trim().replace(/\//g," ").replace(/\-/g," ").split(" "),guessedFormat=["","",""],j=0;j<thing.length;j++)j<guessedFormat.length&&(thing[j]=parseInt(thing[j],10),thing[j]&&(max[j]=!max[j]||max[j]<thing[j]?thing[j]:max[j],"undefined"!=typeof stable[j]?stable[j]!==thing[j]&&(stable[j]=!1):stable[j]=thing[j],31<thing[j]?thing[j]<100?guessedFormat[j]="YY":guessedFormat[j]="YYYY":12<thing[j]&&thing[j]<=31?(guessedFormat[j]="dd",madeDeduction=!0):guessedFormat[j].length||(guessedFormat[j]="mm")));if(madeDeduction){for(j=0;j<stable.length;j++)!1!==stable[j]?12<max[j]&&"YY"!==guessedFormat[j]&&"YYYY"!==guessedFormat[j]&&(guessedFormat[j]="YY"):12<max[j]&&"mm"===guessedFormat[j]&&(guessedFormat[j]="dd");return calculatedFormat=guessedFormat.join("/"),(options.dateFormats||self.dateFormats)[calculatedFormat]?calculatedFormat:(fireEvent("invalidDateFormat"),Highcharts.error("Could not deduce date format"),format)}return format}function deduceAxisTypes(){}var columns,itemDelimiter,lines,self=this,options=inOptions||this.options,csv=options.csv,startRow=options.startRow||0,endRow=options.endRow||Number.MAX_VALUE,startColumn=options.startColumn||0,endColumn=options.endColumn||Number.MAX_VALUE,rowIt=0,dataTypes=[],potDelimiters={",":0,";":0,"\t":0};if(columns=this.columns=[],csv){lines=csv.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(options.lineDelimiter||"\n"),(!startRow||startRow<0)&&(startRow=0),(!endRow||endRow>=lines.length)&&(endRow=lines.length-1),itemDelimiter=options.itemDelimiter?options.itemDelimiter:(itemDelimiter=null,guessDelimiter(lines));var offset=0;for(rowIt=startRow;rowIt<=endRow;rowIt++)"#"===lines[rowIt][0]?offset++:parseRow(lines[rowIt],rowIt-startRow-offset);deduceAxisTypes(),options.columnTypes&&0!==options.columnTypes.length||!dataTypes.length||!dataTypes[0].length||"date"!==dataTypes[0][1]||options.dateFormat||(options.dateFormat=deduceDateFormat(columns[0])),this.dataFound()}return columns},parseTable:function(){var options=this.options,table=options.table,columns=this.columns,startRow=options.startRow||0,endRow=options.endRow||Number.MAX_VALUE,startColumn=options.startColumn||0,endColumn=options.endColumn||Number.MAX_VALUE;table&&("string"==typeof table&&(table=doc.getElementById(table)),each(table.getElementsByTagName("tr"),function(tr,rowNo){startRow<=rowNo&&rowNo<=endRow&&each(tr.children,function(item,colNo){("TD"===item.tagName||"TH"===item.tagName)&&startColumn<=colNo&&colNo<=endColumn&&(columns[colNo-startColumn]||(columns[colNo-startColumn]=[]),columns[colNo-startColumn][rowNo-startRow]=item.innerHTML)})}),this.dataFound())},parseGoogleSpreadsheet:function(){var gr,gc,self=this,options=this.options,googleSpreadsheetKey=options.googleSpreadsheetKey,columns=this.columns,startRow=options.startRow||0,endRow=options.endRow||Number.MAX_VALUE,startColumn=options.startColumn||0,endColumn=options.endColumn||Number.MAX_VALUE;googleSpreadsheetKey&&jQuery.ajax({dataType:"json",url:"https://spreadsheets.google.com/feeds/cells/"+googleSpreadsheetKey+"/"+(options.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",error:options.error,success:function(json){var cell,i,cells=json.feed.entry,cellCount=cells.length,colCount=0,rowCount=0;for(i=0;i<cellCount;i++)cell=cells[i],colCount=Math.max(colCount,cell.gs$cell.col),rowCount=Math.max(rowCount,cell.gs$cell.row);for(i=0;i<colCount;i++)startColumn<=i&&i<=endColumn&&(columns[i-startColumn]=[],columns[i-startColumn].length=Math.min(rowCount,endRow-startRow));for(i=0;i<cellCount;i++)cell=cells[i],gr=cell.gs$cell.row-1,gc=cell.gs$cell.col-1,startColumn<=gc&&gc<=endColumn&&startRow<=gr&&gr<=endRow&&(columns[gc-startColumn][gr-startRow]=cell.content.$t);each(columns,function(column){for(i=0;i<column.length;i++)column[i]===undefined&&(column[i]=null)}),self.dataFound()}})},trim:function(str,inside){return"string"==typeof str&&(str=str.replace(/^\s+|\s+$/g,""),inside&&/^[0-9\s]+$/.test(str)&&(str=str.replace(/\s/g,"")),this.decimalRegex&&(str=str.replace(this.decimalRegex,"$1.$2"))),str},parseTypes:function(){for(var columns=this.columns,col=columns.length;col--;)this.parseColumn(columns[col],col)},parseColumn:function(column,col){var val,floatVal,trimVal,trimInsideVal,dateVal,diff,descending,rawColumns=this.rawColumns,columns=this.columns,row=column.length,firstRowAsNames=this.firstRowAsNames,isXColumn=-1!==inArray(col,this.valueCount.xColumns),backup=[],chartOptions=this.chartOptions,columnType=(this.options.columnTypes||[])[col],forceCategory=isXColumn&&(chartOptions&&chartOptions.xAxis&&"category"===splat(chartOptions.xAxis)[0].type||"string"===columnType);for(rawColumns[col]||(rawColumns[col]=[]);row--;)val=backup[row]||column[row],trimVal=this.trim(val),trimInsideVal=this.trim(val,!0),floatVal=parseFloat(trimInsideVal),rawColumns[col][row]===undefined&&(rawColumns[col][row]=trimVal),forceCategory||0===row&&firstRowAsNames?column[row]=""+trimVal:+trimInsideVal===floatVal?(31536e6<(column[row]=floatVal)&&"float"!==columnType?column.isDatetime=!0:column.isNumeric=!0,column[row+1]!==undefined&&(descending=floatVal>column[row+1])):(dateVal=this.parseDate(val),isXColumn&&isNumber(dateVal)&&"float"!==columnType?(backup[row]=val,column[row]=dateVal,column.isDatetime=!0,column[row+1]!==undefined&&((diff=dateVal>column[row+1])!==descending&&descending!==undefined&&(this.alternativeFormat?(this.dateFormat=this.alternativeFormat,row=column.length,this.alternativeFormat=this.dateFormats[this.dateFormat].alternative):column.unsorted=!0),descending=diff)):(column[row]=""===trimVal?null:trimVal,0!==row&&(column.isDatetime||column.isNumeric)&&(column.mixed=!0)));if(isXColumn&&column.mixed&&(columns[col]=rawColumns[col]),isXColumn&&descending&&this.options.sort)for(col=0;col<columns.length;col++)columns[col].reverse(),firstRowAsNames&&columns[col].unshift(columns[col].pop())},dateFormats:{"YYYY/mm/dd":{regex:/^([0-9]{4})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{1,2})$/,parser:function(match){return Date.UTC(+match[1],match[2]-1,+match[3])}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(match){return Date.UTC(+match[3],match[2]-1,+match[1])},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(match){return Date.UTC(+match[3],match[1]-1,+match[2])}},"dd/mm/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(match){var year=+match[3];return year>(new Date).getFullYear()-2e3?year+=1900:year+=2e3,Date.UTC(year,match[2]-1,+match[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(match){return Date.UTC(+match[3]+2e3,match[1]-1,+match[2])}}},parseDate:function(val){var ret,key,format,match,parseDate=this.options.parseDate,dateFormat=this.options.dateFormat||this.dateFormat;if(parseDate)ret=parseDate(val);else if("string"==typeof val){if(dateFormat)(format=this.dateFormats[dateFormat])||(format=this.dateFormats["YYYY/mm/dd"]),(match=val.match(format.regex))&&(ret=format.parser(match));else for(key in this.dateFormats)if(format=this.dateFormats[key],match=val.match(format.regex)){this.dateFormat=dateFormat=key,this.alternativeFormat=format.alternative,ret=format.parser(match);break}match||("object"==typeof(match=Date.parse(val))&&null!==match&&match.getTime?ret=match.getTime()-6e4*match.getTimezoneOffset():isNumber(match)&&(ret=match-6e4*new Date(match).getTimezoneOffset()))}return ret},rowsToColumns:function(rows){var row,rowsLength,col,colsLength,columns;if(rows)for(columns=[],rowsLength=rows.length,row=0;row<rowsLength;row++)for(colsLength=rows[row].length,col=0;col<colsLength;col++)columns[col]||(columns[col]=[]),columns[col][row]=rows[row][col];return columns},parsed:function(){if(this.options.parsed)return this.options.parsed.call(this,this.columns)},getFreeIndexes:function(numberOfColumns,seriesBuilders){var s,i,referencedIndexes,freeIndexes=[],freeIndexValues=[];for(i=0;i<numberOfColumns;i+=1)freeIndexes.push(!0);for(s=0;s<seriesBuilders.length;s+=1)for(referencedIndexes=seriesBuilders[s].getReferencedColumnIndexes(),i=0;i<referencedIndexes.length;i+=1)freeIndexes[referencedIndexes[i]]=!1;for(i=0;i<freeIndexes.length;i+=1)freeIndexes[i]&&freeIndexValues.push(i);return freeIndexValues},complete:function(){var type,series,data,i,j,r,seriesIndex,chartOptions,builder,freeIndexes,typeCol,index,columns=this.columns,xColumns=[],options=this.options,allSeriesBuilders=[];if(xColumns.length=columns.length,options.complete||options.afterComplete){for(i=0;i<columns.length;i++)this.firstRowAsNames&&(columns[i].name=columns[i].shift());for(series=[],freeIndexes=this.getFreeIndexes(columns.length,this.valueCount.seriesBuilders),seriesIndex=0;seriesIndex<this.valueCount.seriesBuilders.length;seriesIndex++)(builder=this.valueCount.seriesBuilders[seriesIndex]).populateColumns(freeIndexes)&&allSeriesBuilders.push(builder);for(;0<freeIndexes.length;){for((builder=new SeriesBuilder).addColumnReader(0,"x"),-1!==(index=inArray(0,freeIndexes))&&freeIndexes.splice(index,1),i=0;i<this.valueCount.global;i++)builder.addColumnReader(undefined,this.valueCount.globalPointArrayMap[i]);builder.populateColumns(freeIndexes)&&allSeriesBuilders.push(builder)}if(0<allSeriesBuilders.length&&0<allSeriesBuilders[0].readers.length&&(typeCol=columns[allSeriesBuilders[0].readers[0].columnIndex])!==undefined&&(typeCol.isDatetime?type="datetime":typeCol.isNumeric||(type="category")),"category"===type)for(seriesIndex=0;seriesIndex<allSeriesBuilders.length;seriesIndex++)for(builder=allSeriesBuilders[seriesIndex],r=0;r<builder.readers.length;r++)"x"===builder.readers[r].configName&&(builder.readers[r].configName="name");for(seriesIndex=0;seriesIndex<allSeriesBuilders.length;seriesIndex++){for(builder=allSeriesBuilders[seriesIndex],data=[],j=0;j<columns[0].length;j++)data[j]=builder.read(columns,j);series[seriesIndex]={data:data},builder.name&&(series[seriesIndex].name=builder.name),"category"===type&&(series[seriesIndex].turboThreshold=0)}chartOptions={series:series},type&&(chartOptions.xAxis={type:type},"category"===type&&(chartOptions.xAxis.uniqueNames=!1)),options.complete&&options.complete(chartOptions),options.afterComplete&&options.afterComplete(chartOptions)}},update:function(options,redraw){var chart=this.chart;options&&(options.afterComplete=function(dataOptions){chart.update(dataOptions,redraw)},Highcharts.data(options))}}),Highcharts.Data=Data,Highcharts.data=function(options,chartOptions){return new Data(options,chartOptions)},Highcharts.wrap(Highcharts.Chart.prototype,"init",function(proceed,userOptions,callback){var chart=this;userOptions&&userOptions.data?(chart.data=new Data(Highcharts.extend(userOptions.data,{afterComplete:function(dataOptions){var i,series;if(userOptions.hasOwnProperty("series"))if("object"==typeof userOptions.series)for(i=Math.max(userOptions.series.length,dataOptions.series.length);i--;)series=userOptions.series[i]||{},userOptions.series[i]=Highcharts.merge(series,dataOptions.series[i]);else delete userOptions.series;userOptions=Highcharts.merge(dataOptions,userOptions),proceed.call(chart,userOptions,callback)}}),userOptions),chart.data.chart=chart):proceed.call(chart,userOptions,callback)}),(SeriesBuilder=function(){this.readers=[],this.pointIsArray=!0}).prototype.populateColumns=function(freeIndexes){var builder=this,enoughColumns=!0;return each(builder.readers,function(reader){reader.columnIndex===undefined&&(reader.columnIndex=freeIndexes.shift())}),each(builder.readers,function(reader){reader.columnIndex===undefined&&(enoughColumns=!1)}),enoughColumns},SeriesBuilder.prototype.read=function(columns,rowIndex){var columnIndexes,builder=this,pointIsArray=builder.pointIsArray,point=pointIsArray?[]:{};return each(builder.readers,function(reader){var value=columns[reader.columnIndex][rowIndex];pointIsArray?point.push(value):point[reader.configName]=value}),this.name===undefined&&2<=builder.readers.length&&2<=(columnIndexes=builder.getReferencedColumnIndexes()).length&&(columnIndexes.shift(),columnIndexes.sort(),this.name=columns[columnIndexes.shift()].name),point},SeriesBuilder.prototype.addColumnReader=function(columnIndex,configName){this.readers.push({columnIndex:columnIndex,configName:configName}),"x"!==configName&&"y"!==configName&&configName!==undefined&&(this.pointIsArray=!1)},SeriesBuilder.prototype.getReferencedColumnIndexes=function(){var i,columnReader,referencedColumnIndexes=[];for(i=0;i<this.readers.length;i+=1)(columnReader=this.readers[i]).columnIndex!==undefined&&referencedColumnIndexes.push(columnReader.columnIndex);return referencedColumnIndexes},SeriesBuilder.prototype.hasReader=function(configName){var i;for(i=0;i<this.readers.length;i+=1)if(this.readers[i].configName===configName)return!0}}(Highcharts)});